<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
    <head>
        <title>Article</title>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link th:href="@{/css/style.css}" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <div>Article</div>
        <th:block th:if="${#authentication.name == article.user.email}">
            <form method="GET" th:action="@{/articles/{id}/edit(id=${article.id})}">
                <input type="submit" value="Edit" />
            </form>
        </th:block>
        <div class="article">

            <div class="title">
                <h3 th:text="${article.title}">Title</h3>
            </div>

            <div class="new_info">
                <div class="new_date">
                    <span th:text="${#dates.format(article.date, 'dd-MMM-yyyy HH:mm')}">Date</span>
                </div>
                <div class="new_author">
                    <span th:if="${article.user.userDetails}" th:text="${article.user.userDetails.surname + ' ' + article.user.userDetails.name}">Name Surname</span>
                </div>
            </div>

            <div class="content">
                <span th:text="${article.content}">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus a malesuada erat. Praesent facilisis, tellus in euismod luctus, justo neque sodales massa, et sollicitudin diam sapien in elit. Aenean consequat leo vitae lorem elementum, non laoreet risus tincidunt. Cras faucibus non nibh sit amet fermentum. Nulla feugiat leo massa, vel. </span>
            </div>

        </div>
        <hr/>

        <div>
            <span>Comments</span>
            <div class="comments">
                <div class="comment" th:each="comment : ${article.comments}">
                    <div class="name">
                        <span th:if="${comment.userDetails}" th:text="${comment.userDetails.surname + ' ' + comment.userDetails.name}">Name Surname</span>
                    </div>
                    <div class="date">
                        <span th:text="${#dates.format(comment.creationDate, 'dd-MMM-yyyy HH:mm')}"></span>
                    </div>
                    <div class="comment">
                        <span th:text="${comment.comment}"></span>
                    </div>
                    <br/>
                </div>
            </div>
            <th:block sec:authorize="hasRole('CUSTOMER_USER')">
            <p><a href="/articles" th:href="@{/articles/{id}/comments(id=${article.id})}">Add comment</a></p>
            </th:block>
        </div>


        <p><a href="/articles" th:href="@{/articles}">Back</a></p>
    </body>
</html>
